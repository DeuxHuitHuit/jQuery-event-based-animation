/*! jQuery Event Based Animation - v1.1.0 - 2013-02-01
* https://github.com/DeuxHuitHuit/jQuery-event-based-animation
* Copyright (c) 2013 Deux Huit Huit Licensed MIT */
(function(e,t){"use strict";var n=e(window),r=function(e,t){return!e||!t?0:e/t},i=function(e){!window.console||console[console.error?"error":"log"]("[eventAnimate] "+e)},s=function(t,n){e.each(t.properties,function(t,r){return n(r)})},o=function(t,n,r){s(t,function(i){n[i]=e.isFunction(r)?r(i):e.isArray(r)||e.isPlainObject(r)?r[i]:r})},u=function(e,t){return e&&t},a=function(e,t){return e||t},f=function(e,t,n){var r=!n,i=r?u:a,o=r;return s(e,function(n){o=i(o,t(n));if(r&&!o||!r&&o)return!1}),o},l=function(e,t){var n=window,r=n.requestAnimationFrame||n.mozRequestAnimationFrame||n.webkitRequestAnimationFrame||n.msRequestAnimationFrame||n.oRequestAnimationFrame||n.setTimeout;return r(e,r===n.setTimeout?t.tick:t.container.get(0))},c=function(e){var t=window,n=t.cancelAnimationFrame||t.webkitCancelRequestAnimationFrame||t.mozCancelRequestAnimationFrame||t.oCancelRequestAnimationFrame||t.msCancelRequestAnimationFrame||t.clearTimeout;return n(e)};e.isFunction(e.isString)||(e.isString=function(t){return e.type(t)==="string"}),e.fn.eventAnimate=function(t){var n=e(this),u=e.now,a=0,h=a,p={},d={},v={},m={},g={},y=function(e){o(e,p,0),o(e,d,0),o(e,v,0),o(e,v,A(e)),o(e,m,0),o(e,g,0)},b=null,w=!1,E={left:0,top:0},S=function(e,t,n){n.x=t.container.scrollLeft(),n.y=t.container.scrollTop()},x=function(e,t,n){var r=t.container.offset()||E;n.x=e.pageX-r.left,n.y=e.pageY-r.top},T=function(e,t,n){var r=t.container.offset()||E,i=e.originalEvent.touches[0];n.x=i.pageX-r.left,n.y=i.pageY-r.top},N={scroll:S,click:x,mouseover:x,mousemove:x,touchmove:T},C=function(t){var r=[t,H,v],s=t.type||H.event,o=N[s];if(e.isFunction(o)){e.each(arguments,function(t,n){t>0&&r.push(n)}),o.apply(n,r);if(!w||!!H.restartOnEvent)a=u()-1;w||(H.delayStart?k():P())}else i('No strategy found for event "'+s+'"')},k=function(){return _(H)?(c(b),b=null):b=l(P,H),b},L=function(t,r,i,s){var u=function(e){return parseInt(e,10)},a=function(e){return parseFloat(e)},f={},l=e.isFunction(t.durationRatio)&&t.durationRatio.call(n,t,r,i,s)||t.durationRatio||{},c=e.isFunction(t.duration)&&t.duration.call(n,t,r,i,s)||t.duration||{},h=function(e,t){return u(e[t])||u(e)},p=function(e,t){return a(e[t])||a(e)},d=function(e){return p(l,e)||1},v=function(e){return Math.abs(h(c,e)||u(r[e])||1)};return o(t,f,function(t){return v(t)*d(t)}),f},A=function(t){var n=null;return e.isFunction(t.startValues)?n=t.startValues(t):e.isPlainObject(t.startValues)&&(n={},o(t,n,function(n){return t.startValues[n]||g[n]})),n||(n=g),n},O=function(e,t){var n={};return o(e,n,function(n){var i=v[n]-d[n],s=Math.min(1,r(t,p[n]));return d[n]+s*i}),n},M=function(e,t,n,r){!!window.console&&console.log&&!!e.debug&&s(e,function(s){(e.debug===!0||e.debug[s]===!0)&&console.log(h+" Target "+s+" "+parseInt(v[s],10)+" - Start "+parseInt(d[s],10)+" - Linear "+parseInt(t[s],10)+" - Eased "+parseInt(n[s],10)+" - Time "+Math.min(r,p[s])+" - Duration "+p[s])})},_=function(t){return e.isFunction(t.stop)?t.stop(t):!1},D=function(e){return m[e]!==0},P=function(){if(!_(H)){o(H,m,function(t){return v[t]-g[t]});if(f(H,D,!0)){if(a>h){var t=A(H);!H.restartOnEvent||o(H,m,function(n){return v[n]-t[n]}),p=L(H,m,t,v),d=t;if(!w||!!H.restartOnEvent)h=a-1}var r=u()-h,i=function(e){return r<p[e]},s=O(H,r),l={},c=function(t){return e.isNumeric(l[t])},y=e.isPlainObject(H.easing);o(H,l,function(n){var i=y&&H.easing[n],o=!y&&H.easing,u=i||o||e.easing.def||"linear",a=Math.min(r,p[n]),f=v[n]-d[n];return p[n]?e.easing[u](s[n],a,d[n],f,p[n]):v[n]}),M(H,s,l,r),f(H,c,!0)&&(g=l),!w&&e.isFunction(H.start)&&H.start.call(n,r,g),w=!0,f(H,i,!0)?k():(b=null,w=!1),e.isFunction(H.step)&&H.step.call(n,r,g),b===null&&(e.isFunction(H.complete)&&H.complete.call(n,r,g),g=A(H))}else b=null,w=!1}else b=null,w=!1},H=e.extend({container:null,tick:16,event:"scroll",properties:"x y",delayStart:!1,duration:0,durationRatio:1,restartOnEvent:!1,stop:null,step:null,complete:null,start:null,easing:null,strategy:null,startValues:null,debug:!1},t),B=function(t){return t.container=e(t.container||n),t.container.length?(e.isFunction(t.strategy)?N[t.event]=t.strategy:e.isString(t.strategy)?N[t.event]=N[t.strategy]:e.isPlainObject(t.strategy)&&e.each(t.strategy,function(n,r){e.isString(r)?N[n]=N[r]:N[n]=r}),e.isString(t.properties)&&(t.properties=t.properties.split(" ")),!e.isArray(t.properties)||t.properties.length<1?(i("No animatable properties have been set."),n):(y(t),t.container.on(t.event,C),n)):(i("No container found"),n)};return B(H)},e._eventAnimate={_validateEach:f}})(jQuery);