/*! jQuery Event Based Animation - v1.1.0 - 2013-01-08
* https://github.com/DeuxHuitHuit/jQuery-event-based-animation
* Copyright (c) 2013 Deux Huit Huit Licensed MIT */
(function(a,b){"use strict";var c=a(window),d=function(a,b){return!a||!b?0:a/b},e=function(a){!!window.console&&!!console.err&&console.err("[eventAnimate] "+a)},f=function(b,c){a.each(b.properties,function(a,b){return c(b)})},g=function(b,c,d){f(b,function(b){c[b]=a.isFunction(d)?d(b):a.isArray(d)?d[b]:d})},h=function(a,b){return a&&b},i=function(a,b){return a||b},j=function(a,b,c){var d=!c,e=d?h:i,g=d;return f(a,function(a){g=e(g,b(a));if(d&&!g||!d&&g)return!1}),g},k=function(a,b){var c=window,d=c.requestAnimationFrame||c.mozRequestAnimationFrame||c.webkitRequestAnimationFrame||c.msRequestAnimationFrame||c.oRequestAnimationFrame||c.setTimeout;return d(a,d===c.setTimeout?b.tick:b.container.get(0))},l=function(a){var b=window,c=b.cancelAnimationFrame||b.webkitCancelRequestAnimationFrame||b.mozCancelRequestAnimationFrame||b.oCancelRequestAnimationFrame||b.msCancelRequestAnimationFrame||b.clearTimeout;return c(a)};a.isFunction(a.isString)||(a.isString=function(b){return a.type(b)==="string"}),a.fn.eventAnimate=function(b){var c=a(this),h=a.now,i=h(),m=i,n={},o={},p={},q={},r={},s=function(a){g(a,n,0),g(a,o,0),g(a,p,0),g(a,q,0),g(a,r,0)},t=null,u=!1,v={left:0,top:0},w=function(a,b,c){c.x=b.container.scrollLeft(),c.y=b.container.scrollTop()},x=function(a,b,c){var d=b.container.offset()||v;c.x=a.pageX-d.left,c.y=a.pageY-d.top},y=function(a,b,c){var d=b.container.offset()||v,e=a.originalEvent.touches[0];c.x=e.pageX-d.left,c.y=e.pageY-d.top},z={scroll:w,click:x,mouseover:x,mousemove:x,touchmove:y},A=function(b){var d=b.type||J.event,f=z[d];if(a.isFunction(f)){f.call(c,b,J,p);if(!u||!!J.restartOnEvent)i=h()-1;u||(J.delayStart?B():I())}else e('No strategy found for event "'+d+'"')},B=function(){return G(J)?(l(t),t=null):t=k(I,J),t},C=function(b,d,e,f){var h=b.durationRatio||1,i={},j=function(a){return h[a]||h};a.isFunction(h)&&(h=h.call(c,b,d,e,f));if(a.isFunction(b.duration)){var k=b.duration.call(c,b,d,e,f);g(b,i,function(a){var b=k[a]||k||d[a];return Math.abs(b)*j(a)})}else g(b,i,function(a){var c=b.duration[a]||b.duration||d[a];return Math.abs(c)*j(a)});return i},D=function(b){var c=null;return a.isFunction(b.startValues)&&(c=b.startValues(b)),c||(c=r),c},E=function(a,b){var c={};return g(a,c,function e(a){var c=p[a]-o[a],e=Math.min(1,d(b,n[a]));return o[a]+e*c}),c},F=function(a,b,c,d){!!window.console&&console.log&&!!a.debug&&f(a,function e(e){(a.debug===!0||a.debug[e]===!0)&&console.log(m+" Target "+e+" "+parseInt(p[e],10)+" - Start "+parseInt(o[e],10)+" - Linear "+parseInt(b[e],10)+" - Eased "+parseInt(c[e],10)+" - Time "+Math.min(d,n[e])+" - Duration "+n[e])})},G=function(b){return a.isFunction(b.stop)?b.stop(b):!1},H=function(a){return q[a]!==0},I=function(){if(!G(J)){g(J,q,function(a){return p[a]-r[a]});if(j(J,H,!0)){if(i>m){var b=D(J);!J.restartOnEvent||g(J,q,function(a){return p[a]-b[a]}),n=C(J,q,b,p),o=b;if(!u||!!J.restartOnEvent)m=h()-1}var d=h()-m,e=function(a){return d<n[a]},f=E(J,d),k=J.easing||a.easing.def||"linear",l={},s=function(b){return a.isNumeric(l[b])};g(J,l,function(b){return a.easing[k](f[b],Math.min(d,n[b]),o[b],p[b]-o[b],n[b])}),F(J,f,l,d),j(J,s,!0)&&(r=l),!u&&a.isFunction(J.start)&&J.start.call(c,d,r),u=!0,j(J,e,!0)?B():(t=null,u=!1),a.isFunction(J.step)&&J.step.call(c,d,r),t===null&&(a.isFunction(J.complete)&&J.complete.call(c,d,r),r=D(J))}else t=null,u=!1}else t=null,u=!1},J=a.extend({container:null,tick:16,event:"scroll",properties:"x y",delayStart:!1,duration:0,durationRatio:1,restartOnEvent:!1,stop:null,step:null,complete:null,start:null,easing:null,strategy:null,startValues:null,debug:!1},b),K=function(b){return b.container=a(b.container||c),b.container.length?(a.isFunction(b.strategy)?z[b.event]=b.strategy:a.isString(b.strategy)?z[b.event]=z[b.strategy]:a.isPlainObject(b.strategy)&&a.each(b.strategy,function(b,c){a.isString(c)?z[b]=z[c]:z[b]=c}),a.isString(b.properties)&&(b.properties=b.properties.split(" ")),!a.isArray(b.properties)||b.properties.length<1?(e("No animatable properties have been set."),c):(s(b),b.container.on(b.event,A),c)):(e("No container found"),c)};return K(J)},a._eventAnimate={_validateEach:j}})(jQuery);