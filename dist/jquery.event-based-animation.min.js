/*! jQuery Event Based Animation - v1.1.0 - 2013-02-04
* https://github.com/DeuxHuitHuit/jQuery-event-based-animation
* Copyright (c) 2013 Deux Huit Huit Licensed MIT */
(function(a,b){"use strict";var c=a(window),d={left:0,top:0},e=function(a,b){return!a||!b?0:a/b},f=function(a){return parseInt(a,10)||0},g=function(a){return parseFloat(a)||0},h=function(a){!window.console||console[console.error?"error":"log"]("[eventAnimate] "+a)},i=function(b,c){a.each(b.properties,function(a,b){return c(b)})},j=function(b,c,d){return i(b,function(b){c[b]=a.isFunction(d)?d(b):a.isPlainObject(d)?d[b]:d}),c},k=function(a,b){return!!a&&!!b},l=function(a,b){return!!a||!!b},m=function(a,b,c){var d=!c,e=d?k:l,f=d;return i(a,function(a){f=e(f,b(a));if(d&&!f||!d&&f)return!1}),f},n=function(a,b){var c=window,d=c.requestAnimationFrame||c.mozRequestAnimationFrame||c.webkitRequestAnimationFrame||c.msRequestAnimationFrame||c.oRequestAnimationFrame||c.setTimeout;return d(a,d===c.setTimeout?b.tick:b.container.get(0))},o=function(a){var b=window,c=b.cancelAnimationFrame||b.webkitCancelRequestAnimationFrame||b.mozCancelRequestAnimationFrame||b.oCancelRequestAnimationFrame||b.msCancelRequestAnimationFrame||b.clearTimeout;return c(a)},p=function(b,c,d,e,h){var i={},k=a.isFunction(c.durationRatio)&&c.durationRatio.call(b,c,d,e,h)||c.durationRatio||{},l=a.isFunction(c.duration)&&c.duration.call(b,c,d,e,h)||c.duration||{},m=function(a,b){return f(a[b])||f(a)},n=function(a,b){return g(a[b])||g(a)},o=function(a){return n(k,a)},p=function(a){return m(l,a)},q=function(a){return Math.abs(f(d[a]))};return j(c,i,function(a){var b=o(a),c=p(a);return b?b*q(a):c})},q=function(b,c){var d=null;return a.isFunction(b.startValues)?d=b.startValues(b,c):a.isPlainObject(b.startValues)&&(d=j(b,{},function(a){return g(b.startValues[a]||c[a])})),d||(d=c),d},r=function(b,c){var d=a.isPlainObject(b.easing),e=d&&b.easing[c],f=!d&&b.easing;return e||f||a.easing.def||"linear"},s=function(a,b,c){c.x=b.container.scrollLeft(),c.y=b.container.scrollTop()},t=function(a,b,c){var e=b.container.offset()||d;c.x=a.pageX-e.left,c.y=a.pageY-e.top},u=function(a,b,c){var e=b.container.offset()||d,f=a.originalEvent.touches[0];c.x=f.pageX-e.left,c.y=f.pageY-e.top},v={scroll:s,click:t,mouseover:t,mousemove:t,touchmove:u};a.isFunction(a.isString)||(a.isString=function(b){return a.type(b)==="string"}),a.fn.eventAnimate=function(b){var c=a(this),d=a.now,f=0,g=a.extend({},v),k=f,l={},s={},t={},u={},w={},x=function(a){j(a,l,0),j(a,s,0),j(a,u,0),j(a,t,0),j(a,w,q(a,t))},y=null,z=!1,A=function(b){var e=[b,H,t],i=b.type||H.event,j=g[i];if(a.isFunction(j)){a.each(arguments,function(a,b){a>0&&e.push(b)}),j.apply(c,e);if(!z||!!H.restartOnEvent)f=d()-1;z||(H.delayStart?B():G())}else h('No strategy found for event "'+i+'"')},B=function(){return E(H)?(o(y),y=null):y=n(G,H),y},C=function(a,b,c,d){return j(a,{},function f(a){var f=t[a]-d[a],g=Math.min(1,e(b,c[a]));return d[a]+g*f})},D=function(a,b,c,d){!!window.console&&console.log&&!!a.debug&&i(a,function e(e){(a.debug===!0||a.debug[e]===!0)&&console.log(k+" Target "+e+" "+parseInt(t[e],10)+" - Start "+parseInt(s[e],10)+" - Linear "+parseInt(b[e],10)+" - Eased "+parseInt(c[e],10)+" - Time "+Math.min(d,l[e])+" - Duration "+l[e])})},E=function(b){return a.isFunction(b.stop)?b.stop(b):!1},F=function(a){return u[a]!==0},G=function(){if(!E(H)){j(H,u,function(a){return t[a]-w[a]});if(m(H,F,!0)){if(f>k){var b=q(H,w);!H.restartOnEvent||j(H,u,function(a){return t[a]-b[a]}),l=p(c,H,u,b,t);if(!z||!!H.restartOnEvent)s=j(H,{},function(a){return b[a]||w[a]||0}),k=f-1}var e=d()-k,g=function(a){return e<l[a]},h=C(H,e,l,s),i={},n=function(b){return a.isNumeric(i[b])};j(H,i,function(b){var c=r(H,b),d=Math.min(e,l[b]),f=t[b]-s[b];return l[b]?a.easing[c](h[b],d,s[b],f,l[b]):t[b]}),D(H,h,i,e),m(H,n,!0)&&j(H,w,i),!z&&a.isFunction(H.start)&&H.start.call(c,e,w),z=!0,m(H,g,!0)?B():(y=null,z=!1),a.isFunction(H.step)&&H.step.call(c,e,w),y===null&&(a.isFunction(H.complete)&&H.complete.call(c,e,w),w=q(H,w))}else y=null,z=!1}else y=null,z=!1},H=a.extend({container:null,tick:16,event:"scroll",properties:"x y",delayStart:!1,duration:0,durationRatio:1,restartOnEvent:!1,stop:null,step:null,complete:null,start:null,easing:null,strategy:null,startValues:null,debug:!1},b),I=function(b){return b.container=a(b.container||c),b.container.length?(a.isFunction(b.strategy)?g[b.event]=b.strategy:a.isString(b.strategy)?g[b.event]=g[b.strategy]:a.isPlainObject(b.strategy)&&a.each(b.strategy,function(b,c){a.isString(c)?g[b]=g[c]:g[b]=c}),a.isString(b.properties)&&(b.properties=b.properties.split(" ")),!a.isArray(b.properties)||b.properties.length<1?(h("No animatable properties have been set."),c):(x(b),b.container.on(b.event,A),c)):(h("No container found"),c)};return I(H)},a.eventAnimate={"int":f,"float":g,_forEach:i,_setEach:j,_validateEach:m,_getDuration:p,_getStartValues:q,_getEasing:r,_defaultEventStrategies:v}})(jQuery);