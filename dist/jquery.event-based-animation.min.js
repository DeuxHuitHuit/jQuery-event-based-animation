/*! jQuery Event Based Animation - v1.1.0 - 2013-07-19
* https://github.com/DeuxHuitHuit/jQuery-event-based-animation
* Copyright (c) 2013 Deux Huit Huit Licensed MIT */
(function(e,t){"use strict";var n=e(window),r={left:0,top:0},i=function(e,t){return!e||!t?0:e/t},s=function(e){return parseInt(e,10)||0},o=function(e){return parseFloat(e)||0},u=function(e){!window.console||console[console.error?"error":"log"]("[eventAnimate] "+e)},a=function(t,n){e.each(t.properties,function(t,r){return n(r)})},f=function(t,n,r){return a(t,function(i){n[i]=e.isFunction(r)?r(i):e.isPlainObject(r)?r[i]:r}),n},l=function(e,t){return!!e&&!!t},c=function(e,t){return!!e||!!t},h=function(e,t,n){var r=!n,i=r?l:c,s=r;return a(e,function(n){s=i(s,t(n));if(r&&!s||!r&&s)return!1}),s},p=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||window.setTimeout,d=window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.clearTimeout,v=function(e,t){return p(e,p===window.setTimeout?t.tick:t.container.get(0))},m=function(e){return d(e)},g=function(t,n,r,i,u){var a={},l=e.isFunction(n.durationRatio)&&n.durationRatio.call(t,n,r,i,u)||n.durationRatio||{},c=e.isFunction(n.duration)&&n.duration.call(t,n,r,i,u)||n.duration||{},h=function(e,t){return s(e[t])||s(e)},p=function(e,t){return o(e[t])||o(e)},d=function(e){return p(l,e)},v=function(e){return h(c,e)},m=function(e){return Math.abs(s(r[e]))};return f(n,a,function(t){var n=d(t),r=v(t);return n?n*m(t):r})},y=function(t,n){var r=null;return e.isFunction(t.startValues)?r=t.startValues(t,n):e.isPlainObject(t.startValues)&&(r=f(t,{},function(i){return e.isNumeric(t.startValues[i])?o(t.startValues[i]):n[i]})),r||(r=n),r},b=function(t,n){var r=e.isPlainObject(t.easing),i=r&&t.easing[n],s=!r&&t.easing;return i||s||e.easing.def||"linear"},w=function(e,t,n){n.x=t.container.scrollLeft(),n.y=t.container.scrollTop()},E=function(e,t,n){var i=t.container.offset()||r;n.x=e.pageX-i.left,n.y=e.pageY-i.top},S=function(e,t,n){var i=t.container.offset()||r,s=e.originalEvent.touches[0];n.x=s.pageX-i.left,n.y=s.pageY-i.top},x={scroll:w,click:E,mouseover:E,mousemove:E,touchmove:S};e.isFunction(e.isString)||(e.isString=function(t){return e.type(t)==="string"}),e.isFunction(e.isNumeric)||(e.isNumeric=function(t){return!e.isNaN(t)}),e.isFunction(e.fn.on)||(e.fn.on=e.fn.bind),e.fn.eventAnimate=function(t){var n=e(this),r=function(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?Date.now():e.now()},s=0,o=e.extend({},x),l=s,c={},p={},d={},w={},E={},S=function(e){f(e,c,0),f(e,p,0),f(e,w,0),f(e,d,0),f(e,E,y(e,d))},T=null,N=null,C=!1,k=function(){C=!1,T=null},L=function(t){var i=[t,H,d],a=t.type||H.event,f=o[a];if(e.isFunction(f)){e.each(arguments,function(t,n){t>0&&i.push(n)}),f.apply(n,i);if(!C||!!H.restartOnEvent)s=r()-1;C||A(!N)}else u('No strategy found for event "'+a+'"')},A=function(e){return _(H)?(m(T),T=null):!H.delayStart&&!e?P():T=v(P,H),T},O=function(e,t,n,r,s){return f(e,{},function(o){var u=s[o]-r[o],a=Math.min(1,i(t,n[o]));return r[o]+a*u})},M=function(e,t,n,r){!!window.console&&console.log&&!!e.debug&&a(e,function(s){(e.debug===!0||e.debug[s]===!0)&&console.log(l+" Target "+s+" "+parseInt(d[s],10)+" - Start "+parseInt(p[s],10)+" - Linear "+parseInt(t[s],10)+" - Eased "+parseInt(n[s],10)+" - Time "+Math.min(r,c[s])+" - Duration "+c[s])})},_=function(t){return e.isFunction(t.stop)?t.stop(t):!1},D=function(e){return w[e]!==0},P=function(){if(!_(H)){!N||(clearTimeout(N),N=null),f(H,w,function(t){return d[t]-E[t]});if(h(H,D,!0)){if(s>l){var t=y(H,E);if(!C||!!H.restartOnEvent)p=f(H,{},function(n){return t[n]||E[n]||0}),l=s-1,c=g(n,H,w,p,d),E=f(H,E,function(t){return p[t]});f(H,w,function(t){return d[t]-p[t]})}var i=r()-l,o=function(e){return i<c[e]},u=O(H,i,c,p,d),a={},v=function(t){return e.isNumeric(a[t])};f(H,a,function(n){var r=b(H,n),s=Math.min(i,c[n]),o=d[n]-p[n];return c[n]?e.easing[r](u[n],s,p[n],o,c[n]):d[n]}),M(H,u,a,i),h(H,v,!0)&&f(H,E,a),!C&&e.isFunction(H.start)&&H.start.call(n,i,E),C=!0,e.isFunction(H.step)&&H.step.call(n,i,E),h(H,o,!0)?A(!0):i>0?(k(),N=setTimeout(function(){e.isFunction(H.complete)&&H.complete.call(n,i,E)},H.completeDelay),E=y(H,E)):k()}else k()}else k()},H=e.extend({container:null,tick:16,event:"scroll",properties:"x y",delayStart:!1,duration:0,durationRatio:1,restartOnEvent:!1,stop:null,step:null,complete:null,completeDelay:16,start:null,easing:null,strategy:null,startValues:null,debug:!1},t),B=function(t){return t.container=e(t.container||n),t.container.length?(e.isFunction(t.strategy)?o[t.event]=t.strategy:e.isString(t.strategy)?o[t.event]=o[t.strategy]:e.isPlainObject(t.strategy)&&e.each(t.strategy,function(n,r){e.isString(r)?o[n]=o[r]:o[n]=r}),e.isString(t.properties)&&(t.properties=t.properties.split(" ")),!e.isArray(t.properties)||t.properties.length<1?(u("No animatable properties have been set."),n):(S(t),t.container.on(t.event,L),n)):(u("No container found"),n)};return B(H)},e.eventAnimate={"int":s,"float":o,_forEach:a,_setEach:f,_validateEach:h,_getDuration:g,_getStartValues:y,_getEasing:b,_defaultEventStrategies:x},e.raf=function(t,r){return p(function(){t(arguments)&&e.raf(t)},e.extend({tick:16,container:n},r))},e.craf=function(e){d(e)}})(jQuery);